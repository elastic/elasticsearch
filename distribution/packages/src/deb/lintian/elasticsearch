# we don't have a changelog, but we put our copyright file
# under /usr/share/doc/elasticsearch, which triggers this warning
# Note that this is renamed to `no-changelog` in newer versions of
# lintian, but we still support Debian 8+, so we can't change this.
changelog-file-missing-in-native-package

# we intentionally copy our copyright file for all deb packages
copyright-without-copyright-notice

# we still put all our files under /usr/share/elasticsearch even after transition to platform dependent packages
arch-dependent-file-in-usr-share

# we have a bundled jdk, so don't use jarwrapper
missing-dep-on-jarwrapper

# we prefer to not make our config and log files world readable
non-standard-file-perm 0660 != 0644 [etc/default/elasticsearch]
non-standard-dir-perm 2750 != 0755 [etc/elasticsearch/]
non-standard-dir-perm 2750 != 0755 [etc/elasticsearch/jvm.options.d/]
non-standard-file-perm 0660 != 0644 [etc/elasticsearch/*]
non-standard-dir-perm 2750 != 0755 [var/lib/elasticsearch/]
non-standard-dir-perm 2750 != 0755 [var/log/elasticsearch/]
non-standard-executable-perm 0750 != 0755 [etc/init.d/elasticsearch]
executable-is-not-world-readable 0750 [etc/init.d/elasticsearch]
non-standard-file-permissions-for-etc-init.d-script 0750 != 0755 [etc/init.d/elasticsearch]

# the package scripts handle systemd directly and don't need to use deb helpers
maintainer-script-calls-systemctl
prerm-calls-updaterc.d elasticsearch [prerm:94]

# we do not automatically enable the service in init.d or systemd
script-in-etc-init.d-not-registered-via-update-rc.d [etc/init.d/elasticsearch]

# bundled JDK
embedded-library
unstripped-binary-or-object [usr/share/elasticsearch/jdk/*]

# the system java version that lintian assumes is far behind what elasticsearch uses
unknown-java-class-version

# There's no `License` field in Debian control files, but earlier versions
# of `lintian` were more permissive. Override this warning so that we can
# run `lintian` on different releases of Debian. The format of this override
# varies between `lintian` versions.
unknown-field elasticsearch-*.deb License
unknown-field License


# Below is the copy of some of the above rules in format for Lintian versions <= 2.104 (Debian 11)
# Override syntax changes between Lintian versions in a non-backwards compatible way, so we handle it with
# duplication and ignoring some issues in the test code.

# we prefer to not make our config and log files world readable
non-standard-file-perm etc/default/elasticsearch 0660 != 0644
non-standard-dir-perm etc/elasticsearch/ 2750 != 0755
non-standard-dir-perm etc/elasticsearch/jvm.options.d/ 2750 != 0755
non-standard-file-perm etc/elasticsearch/*
non-standard-dir-perm var/lib/elasticsearch/ 2750 != 0755
non-standard-dir-perm var/log/elasticsearch/ 2750 != 0755
non-standard-executable-perm etc/init.d/elasticsearch 0750 != 0755
executable-is-not-world-readable etc/init.d/elasticsearch 0750
non-standard-file-permissions-for-etc-init.d-script etc/init.d/elasticsearch 0750 != 0755

# we do not automatically enable the service in init.d or systemd
script-in-etc-init.d-not-registered-via-update-rc.d etc/init.d/elasticsearch

# the package scripts handle init.d/systemd directly and don't need to use deb helpers
prerm-calls-updaterc.d elasticsearch

# bundled JDK
unstripped-binary-or-object usr/share/elasticsearch/jdk/*

---
setup:
  - do:
      raw:
        method: PUT
        path: "_query_rules/my-ruleset"
        body: |
          {
              "rules": [
                  {
                      "rule_id": "my-rule1",
                      "type": "pinned",
                      "criteria": [
                          {
                              "type": "contains",
                              "metadata": "user_query",
                              "values": [ "pugs", "puggles" ]
                          },
                          {
                              "type": "exact",
                              "metadata": "user_country",
                              "values": [ "us" ]
                          }
                      ],
                      "actions": {
                          "ids": [
                              "id1",
                              "id2"
                          ]
                      }
                  },
                  {
                      "rule_id": "my-rule2",
                      "type": "pinned",
                      "criteria": [
                          {
                              "type": "fuzzy",
                              "metadata": "user_query",
                              "values": [ "rescue dogs" ]
                          }
                      ],
                      "actions": {
                          "docs": [
                              {
                                  "_index": "index1",
                                  "_id": "id3"
                              },
                              {
                                  "_index": "index2",
                                  "_id": "id4"
                              }
                          ]
                      }
                  }
              ]
          }
---
teardown:
  - do:
      raw:
        method: DELETE
        path: "_query_rules/my-ruleset"

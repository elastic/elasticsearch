<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="-20 -80 840 380" xmlns="http://www.w3.org/2000/svg">
    <!-- Title -->
    <text x="50" y="-55" text-anchor="start" font-family="Arial" font-size="16" font-weight="bold" fill="#333">
        Retrieval Augmented Generation with Elasticsearch
    </text>

    <!-- Arrow markers definition -->
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
        </marker>
        <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#0066cc"/>
        </marker>
    </defs>
    
    <!-- Custom Instructions component -->
    <g>
        <text x="510" y="-15" text-anchor="middle" font-family="Arial" font-size="8" fill="#666">Define how the model should</text>
        <text x="510" y="-5" text-anchor="middle" font-family="Arial" font-size="8" fill="#666">parse and render information</text>
        <rect x="450" y="5" width="120" height="35" rx="10" fill="#e8f0f9" stroke="#0066cc"/>
        <text x="510" y="25" text-anchor="middle" font-family="Arial" font-size="12" fill="#333">Custom instructions</text>
        <line x1="510" y1="40" x2="510" y2="95" stroke="#0066cc" stroke-width="2" stroke-dasharray="2" marker-end="url(#arrowhead-blue)"/>
    </g>

    <!-- Search Strategy component -->
    <g>
        <text x="310" y="-15" text-anchor="middle" font-family="Arial" font-size="8" fill="#666">Use full-text, semantic, or hybrid search</text>
        <rect x="250" y="5" width="120" height="35" rx="10" fill="#e8f0f9" stroke="#0066cc"/>
        <text x="310" y="25" text-anchor="middle" font-family="Arial" font-size="12" fill="#333">Search strategy</text>
        <line x1="310" y1="40" x2="310" y2="95" stroke="#0066cc" stroke-width="2" stroke-dasharray="2" marker-end="url(#arrowhead-blue)"/>
    </g>

    <!-- Number circles - positioned uniformly -->
    <g>
        <circle cx="40" cy="85" r="10" fill="#333"/>
        <text x="40" y="89" text-anchor="middle" font-family="Arial" font-size="12" fill="white">1</text>
        
        <circle cx="240" cy="85" r="10" fill="#333"/>
        <text x="240" y="89" text-anchor="middle" font-family="Arial" font-size="12" fill="white">2</text>
        
        <circle cx="440" cy="85" r="10" fill="#333"/>
        <text x="440" y="89" text-anchor="middle" font-family="Arial" font-size="12" fill="white">3</text>
        
        <circle cx="640" cy="85" r="10" fill="#333"/>
        <text x="640" y="89" text-anchor="middle" font-family="Arial" font-size="12" fill="white">4</text>
    </g>

    <!-- Main flow components -->
    <g>
        <!-- Input component -->
        <path d="M50,100 h90 a30,30 0 0 1 0,60 h-90 a30,30 0 0 1 0,-60" fill="#edf7ec" stroke="#006400"/>
        <text x="95" y="135" text-anchor="middle" font-family="Arial" font-size="12" fill="#006400">User query</text>
    </g>

    <g>
        <!-- Search component -->
        <rect x="250" y="100" width="120" height="60" rx="10" fill="#f0f0f0" stroke="#000"/>
        <text x="310" y="135" text-anchor="middle" font-family="Arial" font-size="12" fill="#333">Elasticsearch</text>
        <text x="310" y="180" text-anchor="middle" font-family="Arial" font-size="10" fill="#666">
            <tspan font-weight="bold">Retrieves</tspan> relevant</text>
        <text x="310" y="195" text-anchor="middle" font-family="Arial" font-size="10" fill="#666">documents</text>
    </g>

    <g>
        <!-- Processing component -->
        <rect x="450" y="100" width="120" height="60" rx="10" fill="#f0f0f0" stroke="#000"/>
        <text x="510" y="135" text-anchor="middle" font-family="Arial" font-size="12" fill="#333">Language model</text>
        <text x="510" y="180" text-anchor="middle" font-family="Arial" font-size="10" fill="#666">Processes context &amp;</text>
        <text x="510" y="195" text-anchor="middle" font-family="Arial" font-size="10" fill="#666">
            <tspan font-weight="bold">generates</tspan> answer</text>
    </g>

    <g>
        <!-- Output component -->
        <path d="M710,100 l60,30 l-60,30 l-60,-30 z" fill="#edf7ec" stroke="#006400"/>
        <text x="710" y="135" text-anchor="middle" font-family="Arial" font-size="12" fill="#006400">Response</text>
    </g>
    
    <!-- Flow connections -->
    <line x1="170" y1="130" x2="240" y2="130" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="370" y1="130" x2="440" y2="130" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="570" y1="130" x2="640" y2="130" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
</svg>
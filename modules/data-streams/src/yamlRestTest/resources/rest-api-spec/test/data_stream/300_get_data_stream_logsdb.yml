---
"Test change data stream mode":
  # This test makes sure that when we get a data stream that does not explicitly have an index mode set on it, the API
  # correctly calls additional settings providers (in this case, LogsdbIndexModeSettingsProvider) that set the index
  # mode
  - do:
      indices.put_index_template:
        name: my-template
        body:
          index_patterns: [ logs-test-logsdb ]
          data_stream: { }
          template:
            settings:
              number_of_replicas: 0
            mappings:
              properties:
                field1:
                  type: keyword

  - do:
      indices.create_data_stream:
        name: logs-test-logsdb

  - do:
      indices.get_data_stream:
        name: logs-test-logsdb
  - match: { data_streams.0.name: logs-test-logsdb }
  - match: { data_streams.0.mappings: {} }
  - match: { data_streams.0.settings: {} }
  - match: { data_streams.0.index_mode: logsdb }

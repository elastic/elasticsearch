diff --git a/server/src/main/java/org/elasticsearch/search/fetch/chunk/FetchPhaseResponseChunk.java b/server/src/main/java/org/elasticsearch/search/fetch/chunk/FetchPhaseResponseChunk.java
index 1217122ead88..c3e4d9450511 100644
--- a/server/src/main/java/org/elasticsearch/search/fetch/chunk/FetchPhaseResponseChunk.java
+++ b/server/src/main/java/org/elasticsearch/search/fetch/chunk/FetchPhaseResponseChunk.java
@@ -13,11 +13,7 @@ import org.elasticsearch.action.ActionListener;
 import org.elasticsearch.common.bytes.BytesReference;
 import org.elasticsearch.common.bytes.CompositeBytesReference;
 import org.elasticsearch.common.bytes.ReleasableBytesReference;
-import org.elasticsearch.common.io.stream.BytesStreamOutput;
-import org.elasticsearch.common.io.stream.RecyclerBytesStreamOutput;
-import org.elasticsearch.common.io.stream.StreamInput;
-import org.elasticsearch.common.io.stream.StreamOutput;
-import org.elasticsearch.common.io.stream.Writeable;
+import org.elasticsearch.common.io.stream.*;
 import org.elasticsearch.core.Releasable;
 import org.elasticsearch.core.Releasables;
 import org.elasticsearch.index.shard.ShardId;
@@ -48,6 +44,8 @@ public class FetchPhaseResponseChunk implements Writeable, Releasable {
     // Lazily deserialized on receiving side
     private SearchHit[] deserializedHits;
 
+    private NamedWriteableRegistry namedWriteableRegistry;
+
     /**
      * The type of chunk being sent.
      */
@@ -103,6 +101,7 @@ public class FetchPhaseResponseChunk implements Writeable, Releasable {
         this.expectedDocs = in.readVInt();
         this.sequenceStart = in.readVLong();
         this.serializedHits = in.readBytesReference();
+        this.namedWriteableRegistry = in.namedWriteableRegistry();
     }
 
     @Override
@@ -143,7 +142,7 @@ public class FetchPhaseResponseChunk implements Writeable, Releasable {
     /**
      * Deserializes and returns the hits. Results are cached.
      */
-    public SearchHit[] getHits() throws IOException {
+   /* public SearchHit[] getHits() throws IOException {
         if (deserializedHits == null && serializedHits != null && hitCount > 0) {
             deserializedHits = new SearchHit[hitCount];
             try (StreamInput in = serializedHits.streamInput()) {
@@ -153,6 +152,26 @@ public class FetchPhaseResponseChunk implements Writeable, Releasable {
             }
         }
         return deserializedHits != null ? deserializedHits : new SearchHit[0];
+    }*/
+
+    public SearchHit[] getHits() throws IOException {
+        if (deserializedHits == null && serializedHits != null && hitCount > 0) {
+            deserializedHits = new SearchHit[hitCount];
+            try (StreamInput in = createStreamInput()) {
+                for (int i = 0; i < hitCount; i++) {
+                    deserializedHits[i] = SearchHit.readFrom(in, false);
+                }
+            }
+        }
+        return deserializedHits != null ? deserializedHits : new SearchHit[0];
+    }
+
+    private StreamInput createStreamInput() throws IOException {
+        StreamInput in = serializedHits.streamInput();
+        if (namedWriteableRegistry != null) {
+            in = new NamedWriteableAwareStreamInput(in, namedWriteableRegistry);
+        }
+        return in;
     }
 
     public Type type() {
diff --git a/server/src/main/java/org/elasticsearch/search/fetch/chunk/TransportFetchPhaseResponseChunkAction.java b/server/src/main/java/org/elasticsearch/search/fetch/chunk/TransportFetchPhaseResponseChunkAction.java
index e203190c741b..50e2ddadde96 100644
--- a/server/src/main/java/org/elasticsearch/search/fetch/chunk/TransportFetchPhaseResponseChunkAction.java
+++ b/server/src/main/java/org/elasticsearch/search/fetch/chunk/TransportFetchPhaseResponseChunkAction.java
@@ -19,6 +19,8 @@ import org.elasticsearch.action.support.ActionFilters;
 import org.elasticsearch.action.support.HandledTransportAction;
 import org.elasticsearch.action.support.IndicesOptions;
 import org.elasticsearch.common.bytes.ReleasableBytesReference;
+import org.elasticsearch.common.io.stream.NamedWriteableAwareStreamInput;
+import org.elasticsearch.common.io.stream.NamedWriteableRegistry;
 import org.elasticsearch.common.io.stream.StreamInput;
 import org.elasticsearch.common.io.stream.StreamOutput;
 import org.elasticsearch.common.util.concurrent.EsExecutors;
@@ -71,6 +73,7 @@ public class TransportFetchPhaseResponseChunkAction extends HandledTransportActi
     public static final String ZERO_COPY_ACTION_NAME = TYPE.name() + "[bytes]";
 
     private final ActiveFetchPhaseTasks activeFetchPhaseTasks;
+    private final NamedWriteableRegistry namedWriteableRegistry;
 
     /**
      * Creates a new chunk receiver action.
@@ -83,10 +86,12 @@ public class TransportFetchPhaseResponseChunkAction extends HandledTransportActi
     public TransportFetchPhaseResponseChunkAction(
         TransportService transportService,
         ActionFilters actionFilters,
-        ActiveFetchPhaseTasks activeFetchPhaseTasks
+        ActiveFetchPhaseTasks activeFetchPhaseTasks,
+        NamedWriteableRegistry namedWriteableRegistry
     ) {
         super(TYPE.name(), transportService, actionFilters, Request::new, EsExecutors.DIRECT_EXECUTOR_SERVICE);
         this.activeFetchPhaseTasks = activeFetchPhaseTasks;
+        this.namedWriteableRegistry = namedWriteableRegistry;
         registerZeroCopyHandler(transportService);
     }
 
@@ -107,7 +112,8 @@ public class TransportFetchPhaseResponseChunkAction extends HandledTransportActi
                 FetchPhaseResponseChunk chunk = null;
                 boolean handedOff = false;
 
-                try (StreamInput in = bytesRef.streamInput()) {
+                try (StreamInput rawIn = bytesRef.streamInput();
+                     StreamInput in = new NamedWriteableAwareStreamInput(rawIn, namedWriteableRegistry)) {
                     long coordinatingTaskId = in.readVLong();
                     chunk = new FetchPhaseResponseChunk(in);
 

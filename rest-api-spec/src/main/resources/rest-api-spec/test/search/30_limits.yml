setup:
  - do:
      index:
          index:  test_1
          type:   test
          id:     1
          body:   { foo: bar }

  - do:
      indices.refresh: {}

---
"Request window limits without scroll":
  - do:
      catch:      /Result window is too large, from \+ size must be less than or equal to[:] \[10000\] but was \[10010\]\. See the scroll api for a more efficient way to request large data sets\./
      search:
        index: test_1
        from: 10000

---
"Request with negative from value":
  - do:
      catch:      /\[from\] parameter cannot be negative/
      search:
        index: test_1
        from: -2

---
"Request window limits with scroll":
  - do:
      catch:      /Batch size is too large, size must be less than or equal to[:] \[10000\] but was \[10010\]\. Scroll batch sizes cost as much memory as result windows so they are controlled by the \[index.max_result_window\] index level setting\./
      search:
        index: test_1
        scroll: 5m
        size: 10010

---
"Rescore window limits":
  - do:
      catch:      /Rescore window \[10001\] is too large\. It must be less than \[10000\]\./
      search:
        index: test_1
        body:
          query:
            match_all: {}
          rescore:
              - window_size: 10001
                query:
                  rescore_query:
                    match_all: {}
                  query_weight: 1
                  rescore_query_weight: 2

---
"Docvalues_fields size limit":
  - skip:
      version: " - 5.99.99"
      reason: soft limit for docvalue_fields only available as of 6.0.0

  - do:
      indices.create:
          index: test_2
          body:
            settings:
              index.max_docvalue_fields_search: 2

  - do:
      catch:      /Trying to retrieve too many docvalue_fields\. Must be less than or equal to[:] \[2\] but was \[3\]\. This limit can be set by changing the \[index.max_docvalue_fields_search\] index level setting\./
      search:
        index: test_2
        body:
          query:
            match_all: {}
          docvalue_fields: ["one", "two", "three"]

---
"Script_fields size limit":
  - skip:
      version: " - 5.99.99"
      reason: soft limit for script_fields only available as of 6.0.0

  - do:
      indices.create:
          index: test_3
          body:
            settings:
              index.max_script_fields: 2

  - do:
      catch:      /Trying to retrieve too many script_fields\. Must be less than or equal to[:] \[2\] but was \[3\]\. This limit can be set by changing the \[index.max_script_fields\] index level setting\./
      search:
        index: test_3
        body:
          query:
            match_all: {}
          script_fields: 
            "test1" : { "script" : { "lang": "painless", "source": "1;" }}
            "test2" : { "script" : { "lang": "painless", "source": "1;" }}
            "test3" : { "script" : { "lang": "painless", "source": "1;" }}

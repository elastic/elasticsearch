setup:
  - do:
      indices.create:
          index:  test_stats
  - do:
      index:
          index:  test_stats
          id:     "1"
          body:   { foo: bar }
  - do:
      index:
          index:  test_stats
          id:     "2"
          body:   { foo: baz }

  - do:
      indices.refresh:
        index: [test_stats]

---
"count with stats parameter (single value)":
  - do:
      count:
        index: test_stats
        stats: group1

  - match: {count : 2}

---
"count with stats parameter (multiple comma-separated values)":
  - do:
      count:
        index: test_stats
        stats: group1,group2,group3

  - match: {count : 2}

---
"count with stats parameter and query":
  - do:
      count:
        index: test_stats
        stats: group1
        body:
          query:
            match:
              foo: bar

  - match: {count : 1}

---
"count with stats parameter and query string":
  - do:
      count:
        index: test_stats
        stats: group1,group2
        q: foo:bar

  - match: {count : 1}


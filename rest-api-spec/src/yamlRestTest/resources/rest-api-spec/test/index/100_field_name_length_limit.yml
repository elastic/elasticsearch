"Test field name length limit":
  - do:
      indices.create:
        index: test_index
        body:
          settings:
            index:
              mapping:
                field_name_length:
                  ignore_dynamic_beyond_limit: true
                  limit: 45
          mappings:
            dynamic: true

  - do:
      index:
        index: test_index
        id: 1
        refresh: true
        body:
          test_really_long_field_name_that_will_be_ignored: foo

  - do:
      indices.get_mapping:
        index: test_index

  - match: { test_index.mappings.properties.test_really_long_field_name_that_will_be_ignored: null }

  - do:
      get:
        index: test_index
        id: 1
  - match:
      _source:
        test_really_long_field_name_that_will_be_ignored: foo

---

"Test field name length limit array":
  - do:
      indices.create:
        index: test_index
        body:
          settings:
            index:
              mapping:
                field_name_length:
                  ignore_dynamic_beyond_limit: true
                  limit: 45
          mappings:
            dynamic: true

  - do:
      index:
        index: test_index
        id: 1
        refresh: true
        body:
          test_really_long_field_name_that_will_be_ignored: [ foo, bar, baz ]

  - do:
      indices.get_mapping:
        index: test_index

  - match: { test_index.mappings.properties.test_really_long_field_name_that_will_be_ignored: null }

  - do:
      get:
        index: test_index
        id: 1
  - match:
      _source:
        test_really_long_field_name_that_will_be_ignored: [ foo, bar, baz ]


---

"Test field name length limit synthetic source":
  - do:
      indices.create:
        index: test_index
        body:
          settings:
            index:
              mapping:
                source.mode: synthetic
                field_name_length:
                  ignore_dynamic_beyond_limit: true
                  limit: 45
          mappings:
            dynamic: true

  - do:
      index:
        index: test_index
        id: 1
        refresh: true
        body:
          test_really_long_field_name_that_will_be_ignored: foo

  - do:
      indices.get_mapping:
        index: test_index

  - match: { test_index.mappings.properties.test_really_long_field_name_that_will_be_ignored: null }

  - do:
      get:
        index: test_index
        id: 1
  - match:
      _source:
        test_really_long_field_name_that_will_be_ignored: foo

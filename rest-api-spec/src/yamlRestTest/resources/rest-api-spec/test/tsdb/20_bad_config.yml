---
"dimension with ignore_above":
  - skip:
      version: " - 7.99.99"
      reason: introduced in 8.0.0 to be backported to 7.15.0

  - do:
      catch: /Field \[ignore_above\] cannot be set in conjunction with field \[dimension\]/
      indices.create:
          index: test
          body:
            settings:
              index:
                mode: time_series
            mappings:
              properties:
                "@timestamp":
                  type: date
                metricset:
                  type: keyword
                  dimension: true
                  ignore_above: 1024

---
"dimension with normalizer":
  - skip:
      version: " - 7.99.99"
      reason: introduced in 8.0.0 to be backported to 7.15.0

  - do:
      catch: /Field \[normalizer\] cannot be set in conjunction with field \[dimension\]/
      indices.create:
          index: test
          body:
            settings:
              index:
                mode: time_series
            mappings:
              properties:
                "@timestamp":
                  type: date
                metricset:
                  type: keyword
                  dimension: true
                  normalizer: lowercase

---
"dimension with super long name":
  - skip:
      version: " - 7.99.99"
      reason: introduced in 8.0.0 to be backported to 7.15.0

  - do:
      catch: /Dimension name must be less than \[512\] bytes but \[.+\..+\..+\..+\..+\] was \[524\]/
      indices.create:
          index: test
          body:
            settings:
              index:
                mode: time_series
            mappings:
              properties:
                "@timestamp":
                  type: date
                superduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperlong:
                  properties:
                    superduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperlong:
                      properties:
                        superduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperlong:
                          properties:
                            superduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperlong:
                              properties:
                                superduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperduperlong:
                                  type: keyword
                                  dimension: true

---
"provide sort in time series mode":
  - skip:
      version: " - 7.99.99"
      reason: introduced in 8.0.0 to be backported to 7.15.0

  - do:
      catch: /Can't set \[index\.sort\.field\] in time series mode/
      indices.create:
          index: test
          body:
            settings:
              index:
                sort:
                  field: "@timestamp"
                  order: desc
                mode: time_series
            mappings:
              properties:
                "@timestamp":
                  type: date
                metricset:
                  type: keyword
                  dimension: true

---
"routing_partition_size unsupported":
  # routing_partition_size does the opposite of what we're going for here.....
  - skip:
      version: " - 7.99.99"
      reason: introduced in 8.0.0 to be backported to 7.15.0

  - do:
      catch: /\[index.mode\] is incompatible with \[index.routing_partition_size\]/
      indices.create:
          index: test
          body:
            settings:
              index:
                mode: time_series
                number_of_shards: 10
                routing_partition_size: 2
            mappings:
              properties:
                "@timestamp":
                  type: date
                metricset:
                  type: keyword
                  dimension: true

# TODO on backport do not support turning off soft deletes with tsdb - we won't have good test coverage for it.

// base_conversion.csv
// test data for TO_LONG(string, base), TO_INTEGER(string, base)
// 
// note format from x-pack/plugin/esql/qa/testFixtures/src/main/java/org/elasticsearch/xpack/esql/CsvTestsDataLoader.java
// - commented lines should start with "//"
// - the first non-comment line from the file is the schema line (comma separated field_name:ES_data_type elements)
//   - sub-fields should be placed after the root field using a dot notation for the name:
//       root_field:long,root_field.sub_field:integer
//   - a special _id field can be used in the schema and the values of this field will be used in the bulk request as actual doc ids
// - all subsequent non-comment lines represent the values that will be used to build the _bulk request
// - an empty string "" refers to a null value
// - a value starting with an opening square bracket "[" and ending with a closing square bracket "]" refers to a multi-value field
//   - multi-values are comma separated
//   - commas inside multivalue fields can be escaped with \ (backslash) character
//
// schema line
group:integer,string:keyword,base:integer,expect_long:long,expect_integer:integer,notes:keyword

//
// Test Group 0 - example of the data with an without nulls
//
// ┌────────────────── string         - string for test
// │   ┌────────────── base           - base for test
// │   │  ┌─────────── expect_long    - result of TO_LONG(string,base)
// │   │  │   ┌─────── expect_integer - result of TO_INTEGER(string,base) - not used yet
// │   │  │   │   ┌─── notes          - comments on the test
// ▼   ▼  ▼   ▼   ▼
0,0xff,16,255,255,              TO_LONG("0x32"\, 16)            == 50
0,0xff,,,,                      TO_LONG("0x32"\, null)          == null because base is null
0,,16,,,                        TO_LONG(null\, 16)              == null because string is null
0,,,,,                          TO_LONG(null\, null)            == null because all args are null

//
// Test Group 1
//
//     from GitHub issue https://github.com/elastic/elasticsearch/issues/133728
//     This is for converting a string value to a number given a base.
//     Something similar to what ES EQL does:
//     https://www.elastic.co/docs/reference/query-languages/eql/eql-function-ref#eql-fn-number
//     
//         number("0x32", 16)
//         number("31", 13)
//         number("5")
//             
1,0x32,16,50,50,                TO_LONG("0x32"\, 16)            == 50
1,31,13,40,40,                  TO_LONG("31"\, 13)              == 40
1,5,10,5,5,                     TO_LONG("5"\, 10)               == 5

//
// Test Group 2
// 
//     base 10 tests from "Test the `number` function" 
//     x-pack/plugin/eql/src/test/resources/test_string_functions.toml
//
//         number("314")
//         number("-314", 10)
//         number("+314", 10)
//
2,314,10,314,314,               TO_LONG("314"\, 10)             == 314
2,314,,,,                       TO_LONG("314"\, null)           == null because base is null
2,-314,10,-314,-314,            TO_LONG("-314"\, 10)            == -314
2,-314,,,,                      TO_LONG("-314"\, null)          == null because base is null
2,+314,10,314,314,              TO_LONG("+314"\, 10)            == 314
2,+314,,,,                      TO_LONG("+314"\, null)          == null because base is null

//
// Test Group 3
//
//     base 16 tests from "Test the `number` function"
//     x-pack/plugin/eql/src/test/resources/test_string_functions.toml
//
//         number("0x1337")
//         number("0x1337", 16) 
//         number("0xdeadbeef")
//         number("deadbeef", 16)
//
//     this test will generate InvalidArgumentException parse warnings
//
3,1337,10,1337,1337,            TO_LONG("1337"\, 10)             == 1337
3,1337,16,4919,4919,            TO_LONG("1337"\, 16)             == 4919
3,0x1337,,,,                    TO_LONG("0x1337"\, null)         == null because base is null
3,0x1337,10,,,                  TO_LONG("0x1337"\, 10)           == null because string is invalid in base 10
3,0x1337,16,4919,4919,          TO_LONG("0x1337"\, 16)           == 4919
3,0xdeadbeef,,,,                TO_LONG("0xdeadbeef"\, null)     == null because base is null
3,0xdeadbeef,16,3735928559,,    TO_LONG("0xdeadbeef"\, 16)       == long 3735928559 but integer null because overflow
3,deadbeef,,,,                  TO_LONG("deadbeef"\, null)       == null because base is null
3,deadbeef,16,3735928559,,      TO_LONG("deadbeef"\, 16)         == long 3735928559 but integer null because overflow

//
// Test Group 4
//
//     other base tests from "Test the `number` function"
//     x-pack/plugin/eql/src/test/resources/test_string_functions.toml
//
//         number("52403")
//         number("052403", 8)
//         number("52403", 7)
//
4,52403,,,,                     TO_LONG("52403"\, null)          == null because base is null
4,052403,8,21763,21763,         TO_LONG("052403"\, 8)            == 21763
4,52403,7,12890,12890,          TO_LONG("52403"\, 7)             == 12890

//
// Test Group 5
//
//     For nested calls test    ┌────────────────────────────────────────────┐
//                                                       8              + 2
//                                              ┌──────────────────────┐
//                                      "1000"          "1000"   2
5,1000,2,1000,1000,             TO_LONG(string\, TO_LONG(string\, base) + 2 ) == 1000

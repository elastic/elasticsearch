###############################################
# Tests for MultiMatch function
#

multiMatchWithField
required_capability: multi_match_function

// tag::multi-match-with-field[]
FROM books
| WHERE MULTI_MATCH("Faulkner", "author", "summary", {"fuzziness": 1})
| KEEP book_no, author
| SORT book_no
| LIMIT 5
// end::multi-match-with-field[]
;

// tag::multi-match-with-field-result[]
book_no:keyword | author:text
2378            | [Carol Faulkner, Holly Byers Ochoa, Lucretia Mott]
2713            | William Faulkner
2847            | Colleen Faulkner
2883            | William Faulkner
3293            | Danny Faulkner
// end::multi-match-with-field-result[]
;

testMultiMatchWithOptionsFuzziness
required_capability: multi_match_function

from books 
| where multi_match("Pings", "title", "summary", {"fuzziness": 1})  
| keep book_no;
ignoreOrder:true

book_no:keyword
2714
2675
4023
7140
;

testMultiMatchWithOptionsOperator
required_capability: multi_match_function

// tag::multi-match-with-named-function-params[]
FROM books
| WHERE MULTI_MATCH("Hobbit Back Again", "title", "summary", {"operator": "AND"})
| KEEP title;
// end::multi-match-with-named-function-params[]

// tag::multi-match-with-named-function-params-result[]
title:text
The Hobbit or There and Back Again
// end::multi-match-with-named-function-params-result[]
;

testMultiMatchWithOptionsMinimumShouldMatch
required_capability: multi_match_function

from books 
| where multi_match("Hobbit Back Again", "title", "summary", {"minimum_should_match": 2})
| keep title;

title:text
The Hobbit or There and Back Again
;

testMultiMatchWithNonPushableDisjunctions
required_capability: multi_match_function
required_capability: full_text_functions_disjunctions_compute_engine

from books 
| where multi_match("lord", "title", "summary", {"operator": "AND"}) or length(title) > 130 
| keep book_no
;
ignoreOrder: true

book_no:keyword
2675   
2714   
4023   
7140   
8678
;

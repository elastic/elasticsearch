singleIndexIp
FROM sample_data
| EVAL client_ip = TO_IP(client_ip)
| KEEP @timestamp, client_ip, event_duration, message
| SORT @timestamp DESC
;

@timestamp:date           |  client_ip:ip  |  event_duration:long  |  message:keyword
2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

singleIndexWhereIpLike
FROM sample_data
| WHERE TO_STRING(client_ip) LIKE "172.21.2.*"
| KEEP @timestamp, event_duration, message
| SORT @timestamp DESC
;

@timestamp:date           |  event_duration:long  |  message:keyword
2023-10-23T12:27:28.948Z  |  2764889              |  Connected to 10.1.0.2
2023-10-23T12:15:03.360Z  |  3450233              |  Connected to 10.1.0.3
;

singleIndexTsLong
FROM sample_data_ts_long
| EVAL @timestamp = TO_DATETIME(@timestamp)
| KEEP @timestamp, client_ip, event_duration, message
| SORT @timestamp DESC
;

@timestamp:date           |  client_ip:ip  |  event_duration:long  |  message:keyword
2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

singleIndexIpStats
FROM sample_data
| EVAL client_ip = TO_IP(client_ip)
| STATS count=count(*) BY client_ip
| SORT count DESC, client_ip ASC
| KEEP count, client_ip
;

count:long  |  client_ip:ip  
4           |  172.21.3.15
1           |  172.21.0.5
1           |  172.21.2.113
1           |  172.21.2.162
;

singleIndexIpStringStats
FROM sample_data_str
| EVAL client_ip = TO_IP(client_ip)
| STATS count=count(*) BY client_ip
| SORT count DESC, client_ip ASC
| KEEP count, client_ip
;

count:long  |  client_ip:ip
4           |  172.21.3.15
1           |  172.21.0.5
1           |  172.21.2.113
1           |  172.21.2.162
;

multiIndexIpString
required_capability: union_types
required_capability: metadata_fields

FROM sample_data, sample_data_str METADATA _index
| EVAL client_ip = TO_IP(client_ip)
| KEEP _index, @timestamp, client_ip, event_duration, message
| SORT _index ASC, @timestamp DESC
;

_index:keyword  | @timestamp:date           |  client_ip:ip  |  event_duration:long  |  message:keyword
sample_data     | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data     | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data     | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data     | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data     | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data     | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data     | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_str | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data_str | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data_str | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data_str | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data_str | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data_str | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_str | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

multiIndexIpStringRename
required_capability: union_types
required_capability: metadata_fields

FROM sample_data, sample_data_str METADATA _index
| EVAL host_ip = TO_IP(client_ip)
| KEEP _index, @timestamp, host_ip, event_duration, message
| SORT _index ASC, @timestamp DESC
;

_index:keyword  | @timestamp:date           |  host_ip:ip    |  event_duration:long  |  message:keyword
sample_data     | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data     | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data     | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data     | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data     | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data     | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data     | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_str | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data_str | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data_str | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data_str | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data_str | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data_str | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_str | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

multiIndexIpStringRenameToString
required_capability: union_types
required_capability: metadata_fields

FROM sample_data, sample_data_str METADATA _index
| EVAL host_ip = TO_STRING(TO_IP(client_ip))
| KEEP _index, @timestamp, host_ip, event_duration, message
| SORT _index ASC, @timestamp DESC
;

_index:keyword  | @timestamp:date           |  host_ip:keyword  |  event_duration:long  |  message:keyword
sample_data     | 2023-10-23T13:55:01.543Z  |  172.21.3.15      |  1756467              |  Connected to 10.1.0.1
sample_data     | 2023-10-23T13:53:55.832Z  |  172.21.3.15      |  5033755              |  Connection error
sample_data     | 2023-10-23T13:52:55.015Z  |  172.21.3.15      |  8268153              |  Connection error
sample_data     | 2023-10-23T13:51:54.732Z  |  172.21.3.15      |  725448               |  Connection error
sample_data     | 2023-10-23T13:33:34.937Z  |  172.21.0.5       |  1232382              |  Disconnected
sample_data     | 2023-10-23T12:27:28.948Z  |  172.21.2.113     |  2764889              |  Connected to 10.1.0.2
sample_data     | 2023-10-23T12:15:03.360Z  |  172.21.2.162     |  3450233              |  Connected to 10.1.0.3
sample_data_str | 2023-10-23T13:55:01.543Z  |  172.21.3.15      |  1756467              |  Connected to 10.1.0.1
sample_data_str | 2023-10-23T13:53:55.832Z  |  172.21.3.15      |  5033755              |  Connection error
sample_data_str | 2023-10-23T13:52:55.015Z  |  172.21.3.15      |  8268153              |  Connection error
sample_data_str | 2023-10-23T13:51:54.732Z  |  172.21.3.15      |  725448               |  Connection error
sample_data_str | 2023-10-23T13:33:34.937Z  |  172.21.0.5       |  1232382              |  Disconnected
sample_data_str | 2023-10-23T12:27:28.948Z  |  172.21.2.113     |  2764889              |  Connected to 10.1.0.2
sample_data_str | 2023-10-23T12:15:03.360Z  |  172.21.2.162     |  3450233              |  Connected to 10.1.0.3
;

multiIndexWhereIpString
required_capability: union_types
required_capability: metadata_fields

FROM sample_data, sample_data_str METADATA _index
| WHERE STARTS_WITH(TO_STRING(client_ip), "172.21.2")
| KEEP _index, @timestamp, event_duration, message
| SORT _index ASC, @timestamp DESC
;

_index:keyword  | @timestamp:date           |  event_duration:long  |  message:keyword
sample_data     | 2023-10-23T12:27:28.948Z  |  2764889              |  Connected to 10.1.0.2
sample_data     | 2023-10-23T12:15:03.360Z  |  3450233              |  Connected to 10.1.0.3
sample_data_str | 2023-10-23T12:27:28.948Z  |  2764889              |  Connected to 10.1.0.2
sample_data_str | 2023-10-23T12:15:03.360Z  |  3450233              |  Connected to 10.1.0.3
;

multiIndexWhereIpStringLike
required_capability: union_types
required_capability: metadata_fields

FROM sample_data, sample_data_str METADATA _index
| WHERE TO_STRING(client_ip) LIKE "172.21.2.*"
| KEEP _index, @timestamp, event_duration, message
| SORT _index ASC, @timestamp DESC
;

_index:keyword  | @timestamp:date           |  event_duration:long  |  message:keyword
sample_data     | 2023-10-23T12:27:28.948Z  |  2764889              |  Connected to 10.1.0.2
sample_data     | 2023-10-23T12:15:03.360Z  |  3450233              |  Connected to 10.1.0.3
sample_data_str | 2023-10-23T12:27:28.948Z  |  2764889              |  Connected to 10.1.0.2
sample_data_str | 2023-10-23T12:15:03.360Z  |  3450233              |  Connected to 10.1.0.3
;

multiIndexIpStringStats
required_capability: union_types

FROM sample_data, sample_data_str
| EVAL client_ip = TO_IP(client_ip)
| STATS count=count(*) BY client_ip
| SORT count DESC, client_ip ASC
| KEEP count, client_ip
;

count:long  |  client_ip:ip
8           |  172.21.3.15
2           |  172.21.0.5
2           |  172.21.2.113
2           |  172.21.2.162
;

multiIndexIpStringRenameStats
required_capability: union_types

FROM sample_data, sample_data_str
| EVAL host_ip = TO_IP(client_ip)
| STATS count=count(*) BY host_ip
| SORT count DESC, host_ip ASC
| KEEP count, host_ip
;

count:long  |  host_ip:ip
8           |  172.21.3.15
2           |  172.21.0.5
2           |  172.21.2.113
2           |  172.21.2.162
;

multiIndexIpStringRenameToStringStats
required_capability: union_types

FROM sample_data, sample_data_str
| EVAL host_ip = TO_STRING(TO_IP(client_ip))
| STATS count=count(*) BY host_ip
| SORT count DESC, host_ip ASC
| KEEP count, host_ip
;

count:long  |  host_ip:keyword
8           |  172.21.3.15
2           |  172.21.0.5
2           |  172.21.2.113
2           |  172.21.2.162
;

multiIndexWhereIpStringStats
required_capability: union_types

FROM sample_data, sample_data_str
| WHERE STARTS_WITH(TO_STRING(client_ip), "172.21.2")
| STATS count=count(*) BY message
| SORT count DESC, message ASC
| KEEP count, message
;

count:long  |  message:keyword
2           |  Connected to 10.1.0.2
2           |  Connected to 10.1.0.3
;

multiIndexTsLong
required_capability: union_types
required_capability: metadata_fields

FROM sample_data, sample_data_ts_long METADATA _index
| EVAL @timestamp = TO_DATETIME(@timestamp)
| KEEP _index, @timestamp, client_ip, event_duration, message
| SORT _index ASC, @timestamp DESC
;

_index:keyword      | @timestamp:date           |  client_ip:ip  |  event_duration:long  |  message:keyword
sample_data         | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data         | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data         | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data         | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data         | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data         | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data         | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_ts_long | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data_ts_long | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data_ts_long | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data_ts_long | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data_ts_long | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data_ts_long | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_ts_long | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

multiIndexTsLongRename
required_capability: union_types
required_capability: metadata_fields

FROM sample_data, sample_data_ts_long METADATA _index
| EVAL ts = TO_DATETIME(@timestamp)
| KEEP _index, ts, client_ip, event_duration, message
| SORT _index ASC, ts DESC
;

_index:keyword      | ts:date                   |  client_ip:ip  |  event_duration:long  |  message:keyword
sample_data         | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data         | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data         | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data         | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data         | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data         | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data         | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_ts_long | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data_ts_long | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data_ts_long | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data_ts_long | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data_ts_long | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data_ts_long | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_ts_long | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

multiIndexTsLongRenameToString
required_capability: union_types
required_capability: metadata_fields

FROM sample_data, sample_data_ts_long METADATA _index
| EVAL ts = TO_STRING(TO_DATETIME(@timestamp))
| KEEP _index, ts, client_ip, event_duration, message
| SORT _index ASC, ts DESC
;

_index:keyword      | ts:keyword                |  client_ip:ip  |  event_duration:long  |  message:keyword
sample_data         | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data         | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data         | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data         | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data         | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data         | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data         | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_ts_long | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data_ts_long | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data_ts_long | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data_ts_long | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data_ts_long | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data_ts_long | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_ts_long | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

multiIndexWhereTsLong
required_capability: union_types
required_capability: metadata_fields

FROM sample_data, sample_data_ts_long METADATA _index
| WHERE TO_LONG(@timestamp) < 1698068014937
| KEEP _index, client_ip, event_duration, message
| SORT _index ASC, client_ip ASC
;

_index:keyword       | client_ip:ip  |  event_duration:long  |  message:keyword
sample_data          | 172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data          | 172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_ts_long  | 172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_ts_long  | 172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

multiIndexTsLongStats
required_capability: union_types

FROM sample_data, sample_data_ts_long
| EVAL @timestamp = DATE_TRUNC(1 hour, TO_DATETIME(@timestamp))
| STATS count=count(*) BY @timestamp
| SORT count DESC, @timestamp ASC
| KEEP count, @timestamp
;

count:long  |  @timestamp:date
10          |  2023-10-23T13:00:00.000Z
4           |  2023-10-23T12:00:00.000Z
;

multiIndexTsLongRenameStats
required_capability: union_types

FROM sample_data, sample_data_ts_long
| EVAL hour = DATE_TRUNC(1 hour, TO_DATETIME(@timestamp))
| STATS count=count(*) BY hour
| SORT count DESC, hour ASC
| KEEP count, hour
;

count:long  |  hour:date
10          |  2023-10-23T13:00:00.000Z
4           |  2023-10-23T12:00:00.000Z
;

multiIndexTsLongRenameToDatetimeToStringStats
required_capability: union_types

FROM sample_data, sample_data_ts_long
| EVAL hour = LEFT(TO_STRING(TO_DATETIME(@timestamp)), 13)
| STATS count=count(*) BY hour
| SORT count DESC, hour ASC
| KEEP count, hour
;

count:long  |  hour:keyword
10          |  2023-10-23T13
4           |  2023-10-23T12
;

multiIndexTsLongRenameToStringStats
required_capability: union_types

FROM sample_data, sample_data_ts_long
| EVAL mess = LEFT(TO_STRING(@timestamp), 7)
| STATS count=count(*) BY mess
| SORT count DESC, mess DESC
| KEEP count, mess
;

count:long  |  mess:keyword
7           |  2023-10
4           |  1698069
1           |  1698068
1           |  1698064
1           |  1698063
;

multiIndexWhereTsLongStats
required_capability: union_types

FROM sample_data, sample_data_ts_long
| WHERE TO_LONG(@timestamp) < 1698068014937
| STATS count=count(*) BY message
| SORT count DESC, message ASC
| KEEP count, message
;

count:long  |  message:keyword
2           |  Connected to 10.1.0.2
2           |  Connected to 10.1.0.3
;

multiIndexIpStringTsLong
required_capability: union_types
required_capability: metadata_fields

FROM sample_data* METADATA _index
| EVAL @timestamp = TO_DATETIME(@timestamp), client_ip = TO_IP(client_ip)
| KEEP _index, @timestamp, client_ip, event_duration, message
| SORT _index ASC, @timestamp DESC
;

_index:keyword      | @timestamp:date           |  client_ip:ip  |  event_duration:long  |  message:keyword
sample_data         | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data         | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data         | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data         | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data         | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data         | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data         | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_str     | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data_str     | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data_str     | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data_str     | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data_str     | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data_str     | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_str     | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_ts_long | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data_ts_long | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data_ts_long | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data_ts_long | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data_ts_long | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data_ts_long | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_ts_long | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

multiIndexIpStringTsLongRename
required_capability: union_types
required_capability: metadata_fields

FROM sample_data* METADATA _index
| EVAL ts = TO_DATETIME(@timestamp), host_ip = TO_IP(client_ip)
| KEEP _index, ts, host_ip, event_duration, message
| SORT _index ASC, ts DESC
;

_index:keyword      | ts:date                   |  host_ip:ip    |  event_duration:long  |  message:keyword
sample_data         | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data         | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data         | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data         | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data         | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data         | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data         | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_str     | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data_str     | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data_str     | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data_str     | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data_str     | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data_str     | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_str     | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_ts_long | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data_ts_long | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data_ts_long | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data_ts_long | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data_ts_long | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data_ts_long | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_ts_long | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

multiIndexIpStringTsLongRenameToString
required_capability: union_types
required_capability: metadata_fields

FROM sample_data* METADATA _index
| EVAL ts = TO_STRING(TO_DATETIME(@timestamp)), host_ip = TO_STRING(TO_IP(client_ip))
| KEEP _index, ts, host_ip, event_duration, message
| SORT _index ASC, ts DESC
;

_index:keyword      | ts:keyword                |  host_ip:keyword  |  event_duration:long  |  message:keyword
sample_data         | 2023-10-23T13:55:01.543Z  |  172.21.3.15      |  1756467              |  Connected to 10.1.0.1
sample_data         | 2023-10-23T13:53:55.832Z  |  172.21.3.15      |  5033755              |  Connection error
sample_data         | 2023-10-23T13:52:55.015Z  |  172.21.3.15      |  8268153              |  Connection error
sample_data         | 2023-10-23T13:51:54.732Z  |  172.21.3.15      |  725448               |  Connection error
sample_data         | 2023-10-23T13:33:34.937Z  |  172.21.0.5       |  1232382              |  Disconnected
sample_data         | 2023-10-23T12:27:28.948Z  |  172.21.2.113     |  2764889              |  Connected to 10.1.0.2
sample_data         | 2023-10-23T12:15:03.360Z  |  172.21.2.162     |  3450233              |  Connected to 10.1.0.3
sample_data_str     | 2023-10-23T13:55:01.543Z  |  172.21.3.15      |  1756467              |  Connected to 10.1.0.1
sample_data_str     | 2023-10-23T13:53:55.832Z  |  172.21.3.15      |  5033755              |  Connection error
sample_data_str     | 2023-10-23T13:52:55.015Z  |  172.21.3.15      |  8268153              |  Connection error
sample_data_str     | 2023-10-23T13:51:54.732Z  |  172.21.3.15      |  725448               |  Connection error
sample_data_str     | 2023-10-23T13:33:34.937Z  |  172.21.0.5       |  1232382              |  Disconnected
sample_data_str     | 2023-10-23T12:27:28.948Z  |  172.21.2.113     |  2764889              |  Connected to 10.1.0.2
sample_data_str     | 2023-10-23T12:15:03.360Z  |  172.21.2.162     |  3450233              |  Connected to 10.1.0.3
sample_data_ts_long | 2023-10-23T13:55:01.543Z  |  172.21.3.15      |  1756467              |  Connected to 10.1.0.1
sample_data_ts_long | 2023-10-23T13:53:55.832Z  |  172.21.3.15      |  5033755              |  Connection error
sample_data_ts_long | 2023-10-23T13:52:55.015Z  |  172.21.3.15      |  8268153              |  Connection error
sample_data_ts_long | 2023-10-23T13:51:54.732Z  |  172.21.3.15      |  725448               |  Connection error
sample_data_ts_long | 2023-10-23T13:33:34.937Z  |  172.21.0.5       |  1232382              |  Disconnected
sample_data_ts_long | 2023-10-23T12:27:28.948Z  |  172.21.2.113     |  2764889              |  Connected to 10.1.0.2
sample_data_ts_long | 2023-10-23T12:15:03.360Z  |  172.21.2.162     |  3450233              |  Connected to 10.1.0.3
;

multiIndexWhereIpStringTsLong
required_capability: union_types
required_capability: metadata_fields

FROM sample_data* METADATA _index
| WHERE TO_LONG(@timestamp) < 1698068014937 AND TO_STRING(client_ip) == "172.21.2.162"
| KEEP _index, event_duration, message
| SORT _index ASC, message ASC
;

_index:keyword       |  event_duration:long  |  message:keyword
sample_data          |  3450233              |  Connected to 10.1.0.3
sample_data_str      |  3450233              |  Connected to 10.1.0.3
sample_data_ts_long  |  3450233              |  Connected to 10.1.0.3
;

multiIndexWhereIpStringTsLongStats
required_capability: union_types

FROM sample_data*
| WHERE TO_LONG(@timestamp) < 1698068014937 AND TO_STRING(client_ip) == "172.21.2.162"
| STATS count=count(*) BY message
| SORT count DESC, message ASC
| KEEP count, message
;

count:long  |  message:keyword
3           |  Connected to 10.1.0.3
;

multiIndexWhereIpStringLikeTsLong
required_capability: union_types
required_capability: metadata_fields

FROM sample_data* METADATA _index
| WHERE TO_LONG(@timestamp) < 1698068014937 AND TO_STRING(client_ip) LIKE "172.21.2.16?"
| KEEP _index, event_duration, message
| SORT _index ASC, message ASC
;

_index:keyword       |  event_duration:long  |  message:keyword
sample_data          |  3450233              |  Connected to 10.1.0.3
sample_data_str      |  3450233              |  Connected to 10.1.0.3
sample_data_ts_long  |  3450233              |  Connected to 10.1.0.3
;

multiIndexWhereIpStringLikeTsLongStats
required_capability: union_types

FROM sample_data*
| WHERE TO_LONG(@timestamp) < 1698068014937 AND TO_STRING(client_ip) LIKE "172.21.2.16?"
| STATS count=count(*) BY message
| SORT count DESC, message ASC
| KEEP count, message
;

count:long  |  message:keyword
3           |  Connected to 10.1.0.3
;

multiIndexMultiColumnTypesRenameAndKeep
required_capability: union_types
required_capability: metadata_fields

FROM sample_data* METADATA _index
| WHERE event_duration > 8000000
| EVAL ts = TO_DATETIME(@timestamp), ts_str = TO_STRING(@timestamp), ts_l = TO_LONG(@timestamp), ip = TO_IP(client_ip), ip_str = TO_STRING(client_ip) 
| KEEP _index, ts, ts_str, ts_l, ip, ip_str, event_duration
| SORT _index ASC, ts DESC
;

_index:keyword      | ts:date                   | ts_str:keyword            | ts_l:long      |  ip:ip         |  ip_str:k      |  event_duration:long
sample_data         | 2023-10-23T13:52:55.015Z  | 2023-10-23T13:52:55.015Z  | 1698069175015  |  172.21.3.15   |  172.21.3.15   |  8268153
sample_data_str     | 2023-10-23T13:52:55.015Z  | 2023-10-23T13:52:55.015Z  | 1698069175015  |  172.21.3.15   |  172.21.3.15   |  8268153
sample_data_ts_long | 2023-10-23T13:52:55.015Z  | 1698069175015             | 1698069175015  |  172.21.3.15   |  172.21.3.15   |  8268153
;

multiIndexMultiColumnTypesRenameAndDrop
required_capability: union_types
required_capability: metadata_fields

FROM sample_data* METADATA _index
| WHERE event_duration > 8000000
| EVAL ts = TO_DATETIME(@timestamp), ts_str = TO_STRING(@timestamp), ts_l = TO_LONG(@timestamp), ip = TO_IP(client_ip), ip_str = TO_STRING(client_ip) 
| DROP @timestamp, client_ip, message
| SORT _index ASC, ts DESC
;

event_duration:long | _index:keyword      | ts:date                   | ts_str:keyword            | ts_l:long      |  ip:ip         |  ip_str:k  
8268153             | sample_data         | 2023-10-23T13:52:55.015Z  | 2023-10-23T13:52:55.015Z  | 1698069175015  |  172.21.3.15   |  172.21.3.15
8268153             | sample_data_str     | 2023-10-23T13:52:55.015Z  | 2023-10-23T13:52:55.015Z  | 1698069175015  |  172.21.3.15   |  172.21.3.15
8268153             | sample_data_ts_long | 2023-10-23T13:52:55.015Z  | 1698069175015             | 1698069175015  |  172.21.3.15   |  172.21.3.15
;

multiIndexMultiColumnTypesRename
required_capability: union_types
required_capability: metadata_fields

FROM sample_data* METADATA _index
| WHERE event_duration > 8000000
| EVAL ts = TO_DATETIME(@timestamp), ts_str = TO_STRING(@timestamp), ts_l = TO_LONG(@timestamp), ip = TO_IP(client_ip), ip_str = TO_STRING(client_ip) 
| SORT _index ASC, ts DESC
;

@timestamp:null | client_ip:null | event_duration:long | message:keyword  | _index:keyword      | ts:date                   | ts_str:keyword            | ts_l:long      |  ip:ip         |  ip_str:k
null            | null           |  8268153            | Connection error | sample_data         | 2023-10-23T13:52:55.015Z  | 2023-10-23T13:52:55.015Z  | 1698069175015  |  172.21.3.15   |  172.21.3.15
null            | null           |  8268153            | Connection error | sample_data_str     | 2023-10-23T13:52:55.015Z  | 2023-10-23T13:52:55.015Z  | 1698069175015  |  172.21.3.15   |  172.21.3.15
null            | null           |  8268153            | Connection error | sample_data_ts_long | 2023-10-23T13:52:55.015Z  | 1698069175015             | 1698069175015  |  172.21.3.15   |  172.21.3.15
;

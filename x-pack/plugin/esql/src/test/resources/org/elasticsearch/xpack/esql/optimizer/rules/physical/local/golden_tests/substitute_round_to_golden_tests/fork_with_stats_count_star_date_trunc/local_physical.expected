LimitExec[1000[INTEGER],null]
\_MergeExec[[x{r}, y{r}, hd{r}, _fork{r}]]
  |_ProjectExec[[x{r}, y{r}, hd{r}, _fork{r}]]
  | \_EvalExec[[fork1[KEYWORD] AS _fork]]
  |   \_LimitExec[1000[INTEGER],null]
  |     \_AggregateExec[[hd{r}],[COUNT(*[KEYWORD],true[BOOLEAN],PT0S[TIME_DURATION]) AS x, MAX(long{f},true[BOOLEAN],PT0S[TIME_DURATION]) AS y, hd{r}],FINAL,[hd{r}, $$x$count{r}, $$x$seen{r}, $$y$max{r}, $$y$seen{r}],null]
  |       \_ExchangeExec[[hd{r}, $$x$count{r}, $$x$seen{r}, $$y$max{r}, $$y$seen{r}],true]
  |         \_AggregateExec[[hd{r}],[COUNT(*[KEYWORD],true[BOOLEAN],PT0S[TIME_DURATION]) AS x, MAX(long{f},true[BOOLEAN],PT0S[TIME_DURATION]) AS y, hd{r}],INITIAL,[hd{r}, $$x$count{r}, $$x$seen{r}, $$y$max{r}, $$y$seen{r}],24]
  |           \_FieldExtractExec[long{f}]<[],[]>
  |             \_EvalExec[[$$date$round_to$datetime{f} AS hd]]
  |               \_EsQueryExec[test], indexMode[standard], [_doc{f}, $$date$round_to$datetime{f}], limit[], sort[] estimatedRowSize[20] queryBuilderAndTags [[QueryBuilderAndTags[query={
  "esql_single_value" : {
    "field" : "date",
    "next" : {
      "range" : {
        "date" : {
          "lt" : "2023-10-21T00:00:00.000Z",
          "time_zone" : "Z",
          "format" : "strict_date_optional_time",
          "boost" : 0.0
        }
      }
    },
    "source" : "date_trunc(1 day, date)@2:51"
  }
}, tags=[1697760000000]], QueryBuilderAndTags[query={
  "esql_single_value" : {
    "field" : "date",
    "next" : {
      "range" : {
        "date" : {
          "gte" : "2023-10-21T00:00:00.000Z",
          "lt" : "2023-10-22T00:00:00.000Z",
          "time_zone" : "Z",
          "format" : "strict_date_optional_time",
          "boost" : 0.0
        }
      }
    },
    "source" : "date_trunc(1 day, date)@2:51"
  }
}, tags=[1697846400000]], QueryBuilderAndTags[query={
  "esql_single_value" : {
    "field" : "date",
    "next" : {
      "range" : {
        "date" : {
          "gte" : "2023-10-22T00:00:00.000Z",
          "lt" : "2023-10-23T00:00:00.000Z",
          "time_zone" : "Z",
          "format" : "strict_date_optional_time",
          "boost" : 0.0
        }
      }
    },
    "source" : "date_trunc(1 day, date)@2:51"
  }
}, tags=[1697932800000]], QueryBuilderAndTags[query={
  "esql_single_value" : {
    "field" : "date",
    "next" : {
      "range" : {
        "date" : {
          "gte" : "2023-10-23T00:00:00.000Z",
          "time_zone" : "Z",
          "format" : "strict_date_optional_time",
          "boost" : 0.0
        }
      }
    },
    "source" : "date_trunc(1 day, date)@2:51"
  }
}, tags=[1698019200000]], QueryBuilderAndTags[query={
  "bool" : {
    "must_not" : [
      {
        "exists" : {
          "field" : "date",
          "boost" : 0.0
        }
      }
    ],
    "boost" : 1.0
  }
}, tags=[null]]]]
  \_ProjectExec[[x{r}, y{r}, hd{r}, _fork{r}]]
    \_EvalExec[[fork2[KEYWORD] AS _fork]]
      \_LimitExec[1000[INTEGER],null]
        \_AggregateExec[[hd{r}],[COUNT(*[KEYWORD],true[BOOLEAN],PT0S[TIME_DURATION]) AS x, MIN(long{f},true[BOOLEAN],PT0S[TIME_DURATION]) AS y, hd{r}],FINAL,[hd{r}, $$x$count{r}, $$x$seen{r}, $$y$min{r}, $$y$seen{r}],null]
          \_ExchangeExec[[hd{r}, $$x$count{r}, $$x$seen{r}, $$y$min{r}, $$y$seen{r}],true]
            \_AggregateExec[[hd{r}],[COUNT(*[KEYWORD],true[BOOLEAN],PT0S[TIME_DURATION]) AS x, MIN(long{f},true[BOOLEAN],PT0S[TIME_DURATION]) AS y, hd{r}],INITIAL,[hd{r}, $$x$count{r}, $$x$seen{r}, $$y$min{r}, $$y$seen{r}],24]
              \_FieldExtractExec[long{f}]<[],[]>
                \_EvalExec[[DATETRUNC(P2D[DATE_PERIOD],date{f}) AS hd]]
                  \_FieldExtractExec[date{f}]<[],[]>
                    \_EsQueryExec[test], indexMode[standard], [_doc{f}], limit[], sort[] estimatedRowSize[28] queryBuilderAndTags [[QueryBuilderAndTags[query=null, tags=[]]]]
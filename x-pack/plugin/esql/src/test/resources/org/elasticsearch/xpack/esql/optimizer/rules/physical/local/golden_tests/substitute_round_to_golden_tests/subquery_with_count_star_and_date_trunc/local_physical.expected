ProjectExec[[x{r}, cnt{r}, date{r}]]
\_LimitExec[1000[INTEGER],null]
  \_MergeExec[[alias_integer{r}, boolean{r}, byte{r}, constant_keyword-foo{r}, date{r}, date_nanos{r}, dense_vector{r}, double{r}, float{r}, half_float{r}, integer{r}, ip{r}, keyword{r}, long{r}, scaled_float{r}, semantic_text{r}, short{r}, text{r}, unsigned_long{r}, version{r}, wildcard{r}, cnt{r}, x{r}]]
    |_ProjectExec[[alias_integer{r}, boolean{f}, byte{f}, constant_keyword-foo{f}, date{f}, date_nanos{f}, dense_vector{f}, double{f}, float{f}, half_float{f}, integer{f}, ip{f}, keyword{f}, long{f}, scaled_float{f}, semantic_text{f}, short{f}, text{f}, unsigned_long{f}, version{f}, wildcard{f}, cnt{r}, x{r}]]
    | \_EvalExec[[null[LONG] AS cnt, null[DATETIME] AS x, null[KEYWORD] AS alias_integer]]
    |   \_LimitExec[1000[INTEGER],null]
    |     \_ExchangeExec[[boolean{f}, byte{f}, constant_keyword-foo{f}, date{f}, date_nanos{f}, dense_vector{f}, double{f}, float{f}, half_float{f}, integer{f}, ip{f}, keyword{f}, long{f}, scaled_float{f}, semantic_text{f}, short{f}, text{f}, unsigned_long{f}, version{f}, wildcard{f}],false]
    |       \_ProjectExec[[boolean{f}, byte{f}, constant_keyword-foo{f}, date{f}, date_nanos{f}, dense_vector{f}, double{f}, float{f}, half_float{f}, integer{f}, ip{f}, keyword{f}, long{f}, scaled_float{f}, semantic_text{f}, short{f}, text{f}, unsigned_long{f}, version{f}, wildcard{f}]]
    |         \_FieldExtractExec[boolean{f}, byte{f}, constant_keyword-foo{f}, date{f}, date_nanos{f}, dense_vector{f}, double{f}, float{f}, half_float{f}, integer{f}, ip{f}, keyword{f}, long{f}, scaled_float{f}, semantic_text{f}, short{f}, text{f}, unsigned_long{f}, version{f}, wildcard{f}]<[],[]>
    |           \_EsQueryExec[test], indexMode[standard], [_doc{f}], limit[1000[INTEGER]], sort[] estimatedRowSize[6406] queryBuilderAndTags [[QueryBuilderAndTags[query=null, tags=[]]]]
    \_ProjectExec[[alias_integer{r}, boolean{r}, byte{r}, constant_keyword-foo{r}, date{r}, date_nanos{r}, dense_vector{r}, double{r}, float{r}, half_float{r}, integer{r}, ip{r}, keyword{r}, long{r}, scaled_float{r}, semantic_text{r}, short{r}, text{r}, unsigned_long{r}, version{r}, wildcard{r}, cnt{r}, x{r}]]
      \_EvalExec[[null[KEYWORD] AS alias_integer, null[BOOLEAN] AS boolean, null[INTEGER] AS byte, null[KEYWORD] AS constant_keyword-foo, null[DATETIME] AS date, null[DATE_NANOS] AS date_nanos, null[DENSE_VECTOR] AS dense_vector, null[DOUBLE] AS double, null[DOUBLE] AS float, null[DOUBLE] AS half_float, null[INTEGER] AS integer, null[IP] AS ip, null[KEYWORD] AS keyword, null[LONG] AS long, null[DOUBLE] AS scaled_float, null[TEXT] AS semantic_text, null[INTEGER] AS short, null[TEXT] AS text, null[UNSIGNED_LONG] AS unsigned_long, null[VERSION] AS version, null[KEYWORD] AS wildcard, null[KEYWORD] AS alias_integer]]
        \_LimitExec[1000[INTEGER],null]
          \_AggregateExec[[x{r}],[COUNT(*[KEYWORD],true[BOOLEAN],PT0S[TIME_DURATION]) AS cnt, x{r}],FINAL,[x{r}, $$cnt$count{r}, $$cnt$seen{r}],null]
            \_ExchangeExec[[x{r}, $$cnt$count{r}, $$cnt$seen{r}],true]
              \_FilterExec[$$cnt$count{r} > 0[LONG]]
                \_EsStatsQueryExec[test,null,null,[x{r}, $$cnt$count{r}, $$cnt$seen{r}],ByStat{queryBuilderAndTags=[QueryBuilderAndTags[query={
  "esql_single_value" : {
    "field" : "date",
    "next" : {
      "range" : {
        "date" : {
          "lt" : "2023-10-21T00:00:00.000Z",
          "time_zone" : "Z",
          "format" : "strict_date_optional_time",
          "boost" : 0.0
        }
      }
    },
    "source" : "date_trunc(1 day, date)@1:53"
  }
}, tags=[1697760000000]], QueryBuilderAndTags[query={
  "esql_single_value" : {
    "field" : "date",
    "next" : {
      "range" : {
        "date" : {
          "gte" : "2023-10-21T00:00:00.000Z",
          "lt" : "2023-10-22T00:00:00.000Z",
          "time_zone" : "Z",
          "format" : "strict_date_optional_time",
          "boost" : 0.0
        }
      }
    },
    "source" : "date_trunc(1 day, date)@1:53"
  }
}, tags=[1697846400000]], QueryBuilderAndTags[query={
  "esql_single_value" : {
    "field" : "date",
    "next" : {
      "range" : {
        "date" : {
          "gte" : "2023-10-22T00:00:00.000Z",
          "lt" : "2023-10-23T00:00:00.000Z",
          "time_zone" : "Z",
          "format" : "strict_date_optional_time",
          "boost" : 0.0
        }
      }
    },
    "source" : "date_trunc(1 day, date)@1:53"
  }
}, tags=[1697932800000]], QueryBuilderAndTags[query={
  "esql_single_value" : {
    "field" : "date",
    "next" : {
      "range" : {
        "date" : {
          "gte" : "2023-10-23T00:00:00.000Z",
          "time_zone" : "Z",
          "format" : "strict_date_optional_time",
          "boost" : 0.0
        }
      }
    },
    "source" : "date_trunc(1 day, date)@1:53"
  }
}, tags=[1698019200000]], QueryBuilderAndTags[query={
  "bool" : {
    "must_not" : [
      {
        "exists" : {
          "field" : "date",
          "boost" : 0.0
        }
      }
    ],
    "boost" : 1.0
  }
}, tags=[null]]]}]
import org.elasticsearch.gradle.internal.info.BuildParams

apply plugin: 'elasticsearch.internal-yaml-rest-test'

dependencies {
  yamlRestTestImplementation project(':x-pack:qa:third-party')

  clusterModules project(xpackModule('watcher'))
  clusterModules project(xpackModule('ilm'))
}

restResources {
  restApi {
    include '_common', 'watcher', 'indices', 'cluster', 'search'
  }
}

String pagerDutyServiceKey = System.getenv('pagerduty_service_api_key')

if (!pagerDutyServiceKey) {
  tasks.named("yamlRestTest").configure { enabled = false }
}

if (buildParams.inFipsJvm){
  // Test clusters run with security disabled
  tasks.named("yamlRestTest").configure{enabled = false }
}
